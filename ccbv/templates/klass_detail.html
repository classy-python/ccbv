{% extends "base.html" %}
{# {% load cbv_tags %} #}
{# {% load i18n %} #}
{# {% load static from staticfiles %} #}


{% block title %}{{ klass.name }}{% endblock %}


{% block extra_js %}
<script>
  // Activate accordion
  $(function () {
    $(".collapse").collapse();
    // Method collapsing/expanding buttons
    $("#collapse-methods-btn").click(function() {
      CCBV.method_list.collapse();
    });
    $("#expand-methods-btn").click(function() {
      CCBV.method_list.expand();
    });
  })
</script>
<script src="/ccbv.js"></script>
{% endblock %}

{% block page_header %}
    <h1><small>class</small>&nbsp;{{ klass.name }}</h1>
    <pre>from {{ klass.module }} import {{ klass.name }}</pre>
    <div class="pull-right">
        {# {% with url=object.basic_yuml_url %} #}
        {#     {% if url %} #}
        {#         <a class="btn btn-small btn-info" href="{{ url }}">{% trans "Hierarchy diagram" %}</a> #}
        {#     {% else %} #}
        {#         <span class="btn btn-small btn-info disabled">{% trans "Hierarchy diagram" %}</span> #}
        {#     {% endif %} #}
        {# {% endwith %} #}
        {% if klass.docs_url %}
        <a class="btn btn-small btn-info" href="{{ klass.docs_url }}">Documentation</a>
        {% else %}
        <span class="btn btn-small btn-info disabled">Documentation</span>
        {% endif %}
        <a class="btn btn-small btn-info" href="{{ klass.source_url }}">Source code</a>
    </div>
    {% if klass.docstring %}
      <pre class="docstring">{{ klass.docstring }}</pre>
    {% endif %}
{% endblock %}


{% block content %}
<div class="span12">
  <div class="row">

    {% if klass.ancestors %}
    <div class="span4">
      <h2>Ancestors (<abbr title="Method Resolution Order">MRO</abbr>)</h2>
      <ol start='0' id="ancestors">
        <li><strong>{{ klass.name }}</strong></li>
        {% for ancestor, module in klass.ancestors.items()|reverse %}
        <li>
          <a href="../{{ module }}/{{ ancestor }}.html">
            {% if ancestor in klass.parents %}
            <strong>{{ ancestor }}</strong>
            {% else %}
            {{ ancestor }}
            {% endif %}
          </a>
        </li>
        {% endfor %}
      </ol>
    </div>
    {% endif %}

    {% if klass.children %}
    <div id="descendants" class="span{% if klass.parents %}8{% else %}12{% endif %}">
      <h2>Descendants</h2>
      <ul class="unstyled">
        {% for child in klass.children %}
        <li><a href="../{{ module }}/{{ child }}.html">{{ child }}</a></li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>

  <div class="row">
    <div class="span12">
      <h2>Attributes</h2>
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>&nbsp;</th>
            <th>Defined in</th>
          </tr>
        </thead>
        <tbody>
          {% for name, versions in klass.attributes.items() %}
          {% for version in versions %}
          <tr>
            <td>
                <code class="attribute"{% if not loop.last %} style="text-decoration:line-through"{% endif %}>
                {{ name }} = {{ version.value }}
              </code>
            </td>
            <td>
              {% if version.defining_class.__name__ == klass %}
              {{ version.defining_class.__name__ }}
              {% else %}
              <a href="../{{ version.defining_class.__module__ }}/{{ version.defining_class.__name__ }}.html">
                {{ version.defining_class.__name__ }}
              </a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div id="method-list" class="span12 accordion">
      <div id='method-buttons'>
        <span class="btn btn-small" id="expand-methods-btn">Expand</span>
        <span class="btn btn-small" id="collapse-methods-btn">Collapse</span>
      </div>
      <h2>Methods</h2>
      {% for name, versions in klass.methods.items() %}
      <div class="method accordion-group">
        <header class="accordion-heading btn" data-toggle="collapse" data-target="#{{ name }}">
          <h3>
            <code class="signature highlight">
              <span class="k">def</span>
              <span class="nf">{{ name }}</span><span class="n">{{ versions[0].arguments }}</span>:
            </code>
            {% if versions|length == 1 %}
            <small class="pull-right">{{ versions[0].defining_class.__name__ }}</small>
            {% endif %}
          </h3>
        </header>
        <div id="{{ name }}" class="accordion-body collapse in">
          {% for version in versions|reverse %}

            {% if versions|length > 1 %}
            <div class="namesake accordion-group">
              <header class="accordion-heading" data-toggle="collapse" data-target="#{{ name }}-{{ version.defining_class.__name__ }}">
                <h4 class="accordion-toggle">{{ version.defining_class.__name__ }}</h4>
              </header>
              <div id="{{ name }}-{{ version.defining_class.__name__ }}" class="accordion-body collapse in">
                <div class="accordion-inner">
            {% endif %}

            {% if version.docstring %}
            <pre class="docstring">{{ version.docstring }}</pre>
            {% endif %}

            {% highlight 'python', lineno='inline' %}
            {{ version.code }}
            {% endhighlight %}

            {% if versions|length > 1 %}
                </div>
              </div>
            </div>
            {% endif %}

          {% endfor %}
        </div>
      </div>
    {% endfor %}
    </div>
  </div>

</div>

{% endblock %}
